generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
}

// Minimal tables for Phase 1

model User {
  id           String   @id @default(cuid())
  email        String?  @unique
  phone        String?  @unique
  name         String?

  // Auth method: "google" | "truecaller" | "guest"
  authMethod   String

  streakCount  Int      @default(0)
  lastPlayed   DateTime?
  totalPoints  Int      @default(0)

  stats        UserStats?
  dailyScores  DailyScore[]

  createdAt    DateTime @default(now())
  updatedAt    DateTime @updatedAt
}

model UserStats {
  id            String   @id @default(cuid())
  userId        String   @unique
  user          User     @relation(fields: [userId], references: [id], onDelete: Cascade)

  puzzlesSolved Int      @default(0)
  avgSolveTime  Float    @default(0)

  createdAt     DateTime @default(now())
  updatedAt     DateTime @updatedAt
}

model DailyScore {
  id         String   @id @default(cuid())
  userId     String
  user       User     @relation(fields: [userId], references: [id], onDelete: Cascade)

  date       DateTime
  puzzleId   String
  score      Int
  timeTaken  Int

  createdAt  DateTime @default(now())

  @@unique([userId, date])
  @@index([date])
}